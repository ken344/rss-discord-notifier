# ADR 0001: Go言語の採用

## ステータス
承認済み

## コンテキスト
RSS Discord Notifierプロジェクトを実装するためのプログラミング言語を選定する必要がある。このプロジェクトはGitHub Actionsで定期実行され、RSSフィードを取得してDiscordに通知する比較的シンプルなバッチ処理である。

### 要求事項
- RSSフィードの取得と解析
- HTTP通信（Discord Webhook）
- 並行処理（複数フィードの同時取得）
- JSONやYAMLの扱い
- クロスプラットフォーム対応
- GitHub Actionsとの親和性
- 保守性と可読性

### 検討した選択肢

#### 1. Go
**メリット**:
- シングルバイナリで配布可能（依存関係の管理が容易）
- 標準ライブラリが充実（HTTP、JSON、並行処理）
- goroutineによる効率的な並行処理
- 高速なビルドと実行速度
- GitHub ActionsのランナーでGo環境のセットアップが容易
- 静的型付けによる安全性
- クロスコンパイルが容易

**デメリット**:
- 学習コストが若干ある（Goの慣習に従う必要）
- エラーハンドリングが冗長になる可能性

#### 2. Python
**メリット**:
- スクリプト言語で記述が簡潔
- RSSライブラリが豊富（feedparser等）
- 多くの開発者が慣れている

**デメリット**:
- 依存関係の管理（requirements.txt、仮想環境）
- 実行速度がGoより遅い
- 型安全性が低い（型ヒントはあるが任意）
- バイナリ配布が困難

#### 3. Node.js/TypeScript
**メリット**:
- npmエコシステムが充実
- 非同期処理が得意
- TypeScriptで型安全性を確保可能

**デメリット**:
- node_modulesのサイズが大きい
- 依存関係の管理が複雑
- ビルドプロセスが必要（TypeScript）

#### 4. Rust
**メリット**:
- 高速で安全
- シングルバイナリ配布
- 並行処理が安全

**デメリット**:
- 学習コストが高い
- ビルド時間が長い
- このプロジェクトには過剰なスペック
- エコシステムがGoより小さい

## 決定
**Go言語を採用する**

## 理由

### 1. シングルバイナリ配布の利点
GitHub Actionsで実行する際、依存関係の解決やランタイムのセットアップが最小限で済む。`go build`で生成されたバイナリを実行するだけで動作する。

### 2. 並行処理の容易さ
複数のRSSフィードを効率的に並行取得するために、goroutineとchannelを使った並行処理が非常に書きやすい。

```go
var wg sync.WaitGroup
for _, feed := range feeds {
    wg.Add(1)
    go func(f FeedConfig) {
        defer wg.Done()
        // フィード取得処理
    }(feed)
}
wg.Wait()
```

### 3. 標準ライブラリの充実
- `net/http`: HTTP通信
- `encoding/json`: JSON処理
- `context`: タイムアウト・キャンセル処理
- `time`: 時刻処理

外部依存を最小限に抑えられる。

### 4. GitHub Actionsとの親和性
GitHub Actionsには`actions/setup-go`が公式に提供されており、セットアップが1ステップで完了する。

### 5. クロスプラットフォーム
ユーザーがローカルで実行したい場合も、Windows/macOS/Linuxすべてで同じコードが動作する。

### 6. パフォーマンス
RSSフィードの取得とDiscord通知は頻繁に実行される可能性があり、実行速度の速さは利点となる。

### 7. 型安全性
静的型付けにより、実行前にバグを検出できる。特に設定ファイルの読み込みやAPI通信で有効。

### 8. コミュニティとエコシステム
- RSS/Atomパーサー: `github.com/mmcdole/gofeed`
- YAML解析: `gopkg.in/yaml.v3`
- などの成熟したライブラリが利用可能

## 影響

### ポジティブ
- ✅ 高速な実行とビルド
- ✅ シンプルなデプロイメント（シングルバイナリ）
- ✅ 並行処理の実装が容易
- ✅ 保守性の高いコード
- ✅ GitHub Actionsとのスムーズな統合

### ネガティブ
- ⚠️ Go未経験者には学習コストがある
- ⚠️ エラーハンドリングが冗長になる可能性
- ⚠️ ジェネリクスが比較的新しい機能（Go 1.18以降）

### 軽減策
- 標準的なGoのプロジェクト構造を採用
- 十分なコメントとドキュメントを提供
- 明確なREADMEでセットアップ手順を説明

## 関連決定
- ADR 0002: 状態管理方法
- ADR 0003: 通知フォーマット

## 参考
- [Go公式サイト](https://go.dev/)
- [Effective Go](https://go.dev/doc/effective_go)
- [Standard Go Project Layout](https://github.com/golang-standards/project-layout)

